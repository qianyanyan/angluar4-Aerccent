<form nz-form class="ant-advanced-search-form">
    <div class="searchList">
            <div nz-row [nzGutter]="24">
                <div nz-col [nzSpan]="2"  style="width:8%;text-align: right;padding: 6px 8px !important;font-weight: bolder">搜索条件</div>
                <div nz-col [nzSpan]="3" style="width:14.5%;">
                    <nz-form-item nzFlex>
                    <nz-select name="listOfData.search.fieldMame" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search.fieldMame">
                            <nz-option *ngFor="let option of listTypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                    </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="2">
                    <nz-form-item nzFlex>
                        <nz-select name="listOfData.search.fieldConditions" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search.fieldConditions">
                            <nz-option *ngFor="let option of TypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="3" style="width:14.5%;">
                    <nz-form-item nzFlex>
                            <input *ngIf="listOfData.search.fieldMame !='a.create_order_by_scada'" nz-input placeholder="请输入" ng-trim="false" name="listOfData.search.fieldValue" nzSize="default"
                            [(ngModel)]="listOfData.search.fieldValue">
                            <nz-select *ngIf="listOfData.search.fieldMame =='a.create_order_by_scada'" name="listOfData.search.fieldValue" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search.fieldValue">
                                <nz-option *ngFor="let option of validOption" [nzLabel]="option.label" [nzValue]="option.value">
                                </nz-option>
                            </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="1" ></div>
                <div nz-col [nzSpan]="2">
                    <nz-form-item nzFlex>
                        <nz-select name="listOfData.search2.fieldType" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search2.fieldType">
                            <nz-option *ngFor="let option of statusOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-item>
                </div>
            
                <div nz-col [nzSpan]="3" style="width:14.5%;">
                    <nz-form-item nzFlex>
                        <nz-select name="listOfData.search2.fieldMame" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search2.fieldMame">
                            <nz-option *ngFor="let option of listTypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="2">
                    <nz-form-item nzFlex>
                        <nz-select name="listOfData.search2.fieldConditions" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search2.fieldConditions">
                            <nz-option *ngFor="let option of TypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="3">
                    <nz-form-item nzFlex>
                                <input *ngIf="listOfData.search2.fieldMame !='a.create_order_by_scada'" nz-input placeholder="请输入" ng-trim="false" name="listOfData.search2.fieldValue" nzSize="default"
                            [(ngModel)]="listOfData.search2.fieldValue">
                            <nz-select *ngIf="listOfData.search2.fieldMame =='a.create_order_by_scada'" name="listOfData.search2.fieldValue" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search2.fieldValue">
                                <nz-option *ngFor="let option of validOption" [nzLabel]="option.label" [nzValue]="option.value">
                                </nz-option>
                            </nz-select>
                    </nz-form-item>
                </div>
            </div>
            <div nz-row [nzGutter]="24" *ngIf="isCollapsed">
                <div nz-col [nzSpan]="2"  style="width:8%;">
                    <nz-form-item nzFlex>
                        <nz-select name="listOfData.search3.fieldType" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search3.fieldType">
                            <nz-option *ngFor="let option of statusOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="3">
                    <nz-form-item nzFlex>
                        <nz-select name="listOfData.search3.fieldMame" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search3.fieldMame">
                            <nz-option *ngFor="let option of listTypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="2">
                    <nz-form-item nzFlex>
                        <nz-select name="listOfData.search3.fieldConditions" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search3.fieldConditions">
                            <nz-option *ngFor="let option of TypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                            </nz-option>
                        </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="3">
                    <nz-form-item nzFlex>
                                <input *ngIf="listOfData.search3.fieldMame !='a.create_order_by_scada'" nz-input placeholder="请输入" ng-trim="false" name="listOfData.search3.fieldValue" nzSize="default"
                            [(ngModel)]="listOfData.search3.fieldValue">
                            <nz-select *ngIf="listOfData.search3.fieldMame =='a.create_order_by_scada'" name="listOfData.search3.fieldValue" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search3.fieldValue">
                                <nz-option *ngFor="let option of validOption" [nzLabel]="option.label" [nzValue]="option.value">
                                </nz-option>
                            </nz-select>
                    </nz-form-item>
                </div>
                <div nz-col [nzSpan]="1"></div>
                <div nz-col [nzSpan]="2">
                        <nz-form-item nzFlex>
                            <nz-select name="listOfData.search4.fieldType" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search4.fieldType">
                                <nz-option *ngFor="let option of statusOption" [nzLabel]="option.label" [nzValue]="option.value">
                                </nz-option>
                            </nz-select>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="3">
                        <nz-form-item nzFlex>
                            <nz-select name="listOfData.search4.fieldMame" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search4.fieldMame">
                                <nz-option *ngFor="let option of listTypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                                </nz-option>
                            </nz-select>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="2">
                        <nz-form-item nzFlex>
                            <nz-select name="listOfData.search4.fieldConditions" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search4.fieldConditions">
                                <nz-option *ngFor="let option of TypeOption" [nzLabel]="option.label" [nzValue]="option.value">
                                </nz-option>
                            </nz-select>
                        </nz-form-item>
                    </div>
                    <div nz-col [nzSpan]="3">
                        <nz-form-item nzFlex>
                                    <input *ngIf="listOfData.search4.fieldMame !='a.create_order_by_scada'" nz-input placeholder="请输入" ng-trim="false" name="listOfData.search4.fieldValue" nzSize="default"
                                [(ngModel)]="listOfData.search4.fieldValue">
                                <nz-select *ngIf="listOfData.search4.fieldMame =='a.create_order_by_scada'" name="listOfData.search4.fieldValue" style="width: 100%;" nzPlaceHolder="请选择" [(ngModel)]="listOfData.search4.fieldValue">
                                    <nz-option *ngFor="let option of validOption" [nzLabel]="option.label" [nzValue]="option.value">
                                    </nz-option>
                                </nz-select>
                        </nz-form-item>
                    </div> 
            </div> 
        </div> 
    <div nz-row>
        <div nz-col [nzSpan]="24" style="text-align: center;">
            <button nz-button [nzType]="'primary'" (click)="searchSubmit()">搜索</button>
            <button nz-button (click)="resetForm()">清空</button>
            <span *ngIf="!isCollapsed" class="iconfont icon icon-zhankai"  (click)="toggleCollapsed()"></span>
            <span *ngIf="isCollapsed" class="iconfont icon icon-shouqi"  (click)="toggleCollapsed()"></span>
        </div>
    </div>
</form>
<div class="base-table">
    <div class="table-operations">
        <button nz-button [nzType]="'primary'" (click)="showAdd()">新增</button>
         <button nz-button [nzType]="'primary'" (click)="showUpdate()">修改</button>
        <button nz-button [nzType]="'primary'" (click)="checkDelete()">删除</button>
        <button nz-button [nzType]="'primary'" (click)="isImport=true">导入</button>
        <button nz-button [nzType]="'primary'" nz-popover nzTitle="导出类型" [nzContent]="contentTemplate"  nzPlacement="bottomRight">导出</button>
    </div>
    <nz-table 
        #ajaxTable [nzData]="data"        
        [nzLoading]="loading" 
        [nzFrontPagination]="false"  
        [nzShowPagination]="false">
        <thead (nzSortChange)="sort($event)" nzSingleSort>
            <tr>
            <th nzShowCheckbox [(nzChecked)]="allChecked" [nzIndeterminate]="indeterminate" (nzCheckedChange)="checkAll($event)"></th>
            <th nzShowSort nzSortKey="a.shop_order_code">编码</th>
            <th nzShowSort nzSortKey="a.erp_order_type">ERP订单类型</th>
            <th nzShowSort nzSortKey="a.description">描述</th>
            <th nzShowSort nzSortKey="a.create_order_by_scada">是否由SCADA创建</th>
            <th nzShowSort nzSortKey="a.creation_date">创建时间</th>
            <th nzShowSort nzSortKey="a.last_update">更新时间</th>
            <th nzShowSort nzSortKey="b.account_name">更新人</th>
           
        </thead>
        <tbody>
            <tr *ngFor="let data of ajaxTable.data">
                <td nzShowCheckbox [(nzChecked)]="data.checked" (nzCheckedChange)="refreshStatus()"></td>
                <td>{{data.shop_order_code}}</td>
                <td>{{data.erp_order_type}}</td>
                <td>{{data.description}}</td>
                <td><span *ngIf="data.create_order_by_scada==1">是</span> <span *ngIf="data.create_order_by_scada==0">否</span></td>
                <td>{{data.creation_date}}</td>
                <td>{{data.last_update}}</td>
                <td>{{data.account_name}}</td>
               
            </tr>
        </tbody>
    </nz-table>
</div>

<nz-modal [(nzVisible)]="isAdd" nzTitle="新增订单类型" [nzMaskClosable]="false"  (nzOnCancel)="hideAdd()" (nzOnOk)="addSubmit()">
    <form nz-form class="ant-advanced-search-form">
        <div nz-row [nzGutter]="24">
            <div nz-col [nzSpan]="24">
                <nz-form-item nzFlex>
                    <label>编码:</label>
                    <input nz-input placeholder="请输入编码" maxlength="20" name="add.shop_order_code" nzSize="default" [(ngModel)]="add.shop_order_code">
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="24">
                    <nz-form-item nzFlex>
                        <label>ERP订单类型:</label>
                        <input nz-input placeholder="请输入ERP订单类型" maxlength="4" name="add.erp_order_type" nzSize="default" [(ngModel)]="add.erp_order_type">
                    </nz-form-item>
                </div>
            <div nz-col [nzSpan]="24">
                <nz-form-item nzFlex>
                    <label>描述:</label>
                    <input nz-input placeholder="请输入描述" maxlength="50" name="add.description" nzSize="default" [(ngModel)]="add.description">
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="12">
                <nz-form-item nzFlex>
                    <label>是否由SCADA创建:</label>
                    <nz-switch name="add.create_order_by_scada" [(ngModel)]="add.create_order_by_scada"></nz-switch>
                </nz-form-item>
            </div>
        </div>  
    </form>
</nz-modal>

<nz-modal [(nzVisible)]="isUpdate" nzTitle="更新订单类型" [nzMaskClosable]="false"  (nzOnCancel)="hideUpdate()" (nzOnOk)="updateSubmit()">
    <form nz-form class="ant-advanced-search-form">
        <div nz-row [nzGutter]="24">
            <div nz-col [nzSpan]="24">
                <nz-form-item nzFlex>
                    <label>编码:</label>
                    <input nz-input placeholder="请输入编码" maxlength="20" name="update.shop_order_code" nzSize="default" [(ngModel)]="update.shop_order_code">
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="24">
                <nz-form-item nzFlex>
                    <label>ERP订单类型:</label>
                    <input nz-input placeholder="请输入ERP订单类型" maxlength="4" name="update.erp_order_type" nzSize="default" [(ngModel)]="update.erp_order_type">
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="24">
                <nz-form-item nzFlex>
                    <label>订单类型描述:</label>
                    <input nz-input placeholder="请输入订单类型描述" maxlength="50" name="update.description" nzSize="default" [(ngModel)]="update.description">
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="12">
                <nz-form-item nzFlex>
                    <label>是否由SCADA创建:</label>
                    <nz-switch name="update.create_order_by_scada" [(ngModel)]="update.create_order_by_scada"></nz-switch>
                </nz-form-item>
            </div>
        </div>  
    </form>
</nz-modal>

<nz-modal [nzVisible]="isImport"   [nzFooter]="funTemplate" (nzOnCancel)="isImport=false">
        <form nz-form   class="login-form"    >
        <div nz-row [nzGutter]="24">
                <nz-form-item nzFlex  >
                <div nz-col [nzSpan]="24">
                        <nz-upload *ngIf="isImport"
                        [(nzFileList)]="fileList"
                        [nzBeforeUpload]="beforeUpload"> 
                        <button nz-button>
                        <i nz-icon type="upload"></i><span>导入文件</span>
                        </button>
                    </nz-upload>
                </div>
            </nz-form-item>
            <div nz-col [nzSpan]="12">
                <nz-form-item nzFlex  >
                    <label class="lab-name">导入前清空目标数据:</label>
                    <nz-switch name="import.is_empty" [(ngModel)]="import.is_empty" ></nz-switch>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="12">
                <nz-form-item nzFlex  >
                    <label  class="lab-name">导入时不更新语言包:</label>
                    <nz-switch name="import.is_no_lang" (ngModelChange)="changeLang(false)" [(ngModel)]="import.is_no_lang"></nz-switch>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="12">
                <nz-form-item nzFlex  >
                    <label  class="lab-name">导入全部数据:</label>
                    <nz-switch name="import.is_all" (ngModelChange)="changeLang(false)" [(ngModel)]="import.is_all"></nz-switch>
                </nz-form-item>
            </div>
            <div nz-col [nzSpan]="12">
                <nz-form-item nzFlex  >
                    <label  class="lab-name">导入多语言数据:</label>
                    <nz-switch name="import.is_lang"  (ngModelChange)="changeLang(true)" [(ngModel)]="import.is_lang"></nz-switch>
                </nz-form-item>
            </div>
        </div>
         </form>
  </nz-modal>

<ng-template #contentTemplate>
    <div>
        <p><a href="/assets/excel/unit.xls">导出模板</a></p>
        <p><a href="{{export}}?type=1">导出样例模板</a></p>
        <p><a href="{{export}}?type=2">导出全部数据</a></p>
        <p><a href="{{export}}?type=3">导出语言配置表</a></p>
    </div>
</ng-template>

<ng-template #funTemplate>
    <button nz-button (click)="isImport=false">取消</button>
    <button nz-button [nzType]="'primary'" [nzLoading]="uploading" (click)="handleUpload()" [disabled]="fileList.length == 0" style="margin-top: 16px">
        {{ uploading ? 'Uploading' : '确定' }}
    </button>
</ng-template>